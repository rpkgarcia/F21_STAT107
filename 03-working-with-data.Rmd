# Working with Data Sets

Here let me add some text. I'll add more text. 


## Getting Data Sets in Our Working Environment

### Built-In Data {-}

As discussed last week, there are built in objects which are not loaded into the global environment, but can be called upon at any time.  For example `pi` returns the value `r pi`.  Similarly, there are built in data sets that are ready to be used and loaded at a moments notice.

1) To see a list of built in data sets type in the console: 

```{r}
data()
```

2) These data sets can be used even if they are not listed in the global environment. For example, if you would like to load the data set \texttt{cars} in the global environment, run the following command: 

```{r, eval = F}
data("cars")
```


### Importing Data {-}

Although built-in data sets are convient, most the time we need to load our own datasets. We load our own data sets by using a function specifically designed for the file type of interest.  This function usually uses the file path location as an arguement. This can be done in many different ways; however, we will only go over two. 

**Option 1**

1) Download the file `InsectData.csv` from *iLearn*.  Save this file in a spot in your computer you will remember. 

2) In the **Enviroment** window (upper left window), click on the **Import Dataset** button.  A drop down menu will appear.  Select the **From Text (base)...** option.  Find the file `InsectData.csv` and select it. 

3) A pop up menu will appear giving you options for loading in the file, and showing a preview of what the file will look like once loaded. Select the appropriate options and click **Import**.

4) A new line of code has generated in the console which will read the data into your current environment.  Copy and paste this into your R script document if you would like to save this line of code for later.  You will have to reload this file into your environment each time you start a new `R` session and would like to use this file. 

**Option 2**

1) Download the file `InsectData.csv` from **iLearn**.  Save this file in a spot in your computer you will remember. 

2) In the lower right hand window select the **File** tab.  Now search for the file which you have saved `InsectData.csv`.  

3) Click on the file `InsectData.csv` in order to see a dropdown menu.  Select **Import Dataset...**

4) A window will appear which will give you options and a preview of your file. Select appropriate options if needed then click **Import**. 

5) A new line of code has generated in the console which will read the data into your current environment.  Copy and paste this into your R script document if you would like to save this line of code for later.  You will have to reload this file into your environment each time you start a new `R` session and would like to use this file. 


### Downloading Data {-}

```{r}
source("https://rpkgarcia.github.io/LearnRBook/data_sets/InsectData.csv")

```


## Basic Data Manipulation

Lets recall a few useful things about data frames. As we learned already, data sets are contained in an object called a data frame. One can view this as a specialized table of rows and columns, where each column is a data variable, such as weight or gender, and each row is a single observation. All of the values within a column must be the same data type (numeric, character, logical, etc.). Data frames can be created within `R` or imported from text or spreadsheet files or from the web. 

```{r}
gender = c("M", "F", "M", "M", "F")
age = c(35, 30, 31, 28, 40)
weight = c(152, 124, 127, 189, 133)
pets = c(TRUE, TRUE, FALSE, FALSE, TRUE)

mydata = data.frame(gender, age, weight)
mydata
```


We have various `R` functions that help provide information about the data frame.

```{r}
# How many rows
nrow(mydata)

# How many columns
ncol(mydata)

# Rows, Columns
dim(mydata)

# Colnames
colnames(mydata)
names(mydata)

```


The `summary()` function is a powerful command that gives you some summary statistics about the variales in the data frame. 

```{r}
summary(mydata)
```

The summary statistics are listed below the names of the variables. Since gender is a character variable, `R` gives you the frequencies of each unique value. In this example there are three values of F and two values of M. Since age and weight are numeric, `R` computes and returns the minimum, 1st quartile (25th percentile), median, mean, 3rd quartile (75th percentile), and maximum values. If you have many data values, this is a quick way to get a feel for how the data are distributed.

Square brackets followed by the row, column can be used to return a specific data value. For example, to get the datum in the 3rd row, 2nd column.

```{r}
mydata[3,2]
```

If you leave out the number before or after the comma, the entire column or row is returned. 

```{r}
mydata[3,]

mydata[,2]

```

You can also access variables by name instead of column number. Use a dollar sign and the name of the variable (no spaces). This usually makes the R code more readable. 

```{r}
mydata$weight[4]

mydata$weight
```

The colon operator can be used to generate a sequence of indices. Typing a:b will produce a range of integers $a$, $a+1$,..., $b$.

```{r}
mydata[2:4,]

mydata$age[3:5]
```

You can use logical conditions to obtain subsets of the data. A logical value of `TRUE` will return a data row and a logical of `FALSE` omits that row.

```{r}
males = subset(mydata, mydata$gender == "M")
males
```


To subset by all values which are NOT equal to a condition we can use the logical operator `!=`.
```{r}
females = subset(mydata, mydata$gender != "M")
females
```

Data can be sorted using the `order()` function. This function returns the ranks of the variable being sorted. Including more than one variable allows a "nested sort," where the second variable, third variable, etc., is used when there are ties in the sorting based on the previous variables.

```{r}
order(mydata$weight)

mydata[order(mydata$weight),]
```

The ranks are used as row indices for the data frame. Notice that the observations are sorted by the last column, `weight`. We can sort by more than one variable. Let’s first sort by `gender` alone and then by `gender` followed by `weight` and see what we get.


```{r}
mydata[order(mydata$gender), ]

mydata[order(mydata$gender, mydata$weight), ]

```

To reorder a vector from smallest to largest we can also condiser the sort() function. 

```{r}
sort(mydata$age)
```

One can add and remove variables and observations from a data frame. One can add a new variable (column) to a data frame by defining a new variable and assigning values to it. Below we add a set of heights (in cm) to the data frame.

```{r}
hghts = c(169, 161, 149, 165, 155)
hghts

mydata$height = hghts
mydata
```

We can also add a new column using the `cbind()` function. In addition, if we have a missing value, or a blank value, we can use the object `NA` to indicate the lack of a value. 

```{r}
fav_color = c("Red", NA, "Purple", NA, "Red")

mydata = cbind(mydata, fav_color)
mydata
```

We can drop check for `NA` values using the `is.na()` function. 

```{r}
is.na(mydata)
```

We can remove all rows with `NA` values using `na.omit()`. 
```{r}
na.omit(mydata)
```


One can drop a variable (column) by setting it equal to the `R` value `NULL`.

```{r}
mydata$fav_color = NULL
mydata
```

Be careful using these methods. Once a variable or row is dropped, it’s gone. Rows can be added to a data frame using the `rbind()` (row bind) function. Because our columns have different data types, we will create a list object and then add it as a new row. 


```{r}
newobs = list("M", 23, 136, 160)
newdata = rbind(mydata, newobs)
newdata
```

We can also use `rbind()` to append one data frame to another. We can do this with the variables `males` and `females` created above still exist in your R environment. 

```{r}
males
females
rbind(males, females)
```

One can also remove rows from a data frame. Using negative index values has the same effect as including all the indices except the negative ones.

```{r}
mydata[-c(2,4), ]
```


The `table()` function can also be used to cross-tabulate categorical data.  Let’s create a frequency table of smokers and non-smokers for both genders.

```{r}
table(mtcars$cyl)
```

The zero is for nonsmokers and the one is for smokers. We can also create a frequency table of general health classifications for both genders.

```{r}
table(mtcars$cyl, mtcars$vs)
```

